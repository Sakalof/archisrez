# Архисрез
Программа для копирования файлов на основании списков. Мелкий помощник в компьютерной криминалистике.

Основное предназначение - обрабатывать отчеты сделанные в программе **"Архивариус 3000"** (так как это 
до сих пор лучшая программа для поиска ключевых слов, хоть и не криминалистическая. **Белка**, shame 
on you!)

Довольно частая задача эксперта (по крайней мере, лет пять назад таковой была) поиск файлов по ключевым 
словам, перечисленным в постановлении. Для поиска чаще всего используется **"Архивариус 3000"**. И 
скопировать обнаруженные файлы можно не выходя из **Архивариуса**. Но когда количество ключевых слов 
исчисляется десятками, а количество обнаруженных файлов - десятками тысяч, становится тяжеловато. 
Помимо неудобного копирования у эксперта возникает вопрос: а точно ли файлы скопировались? Потому что 
логов копирования **Архивариус** не ведет.

Программа **Архисрез** призвана решить две проблемы - реализовать удобное копирование обнаруженных 
файлов и их удобное представление в виде отчета для инициатора.

Программа разбита на три секции. При обработке списков **Архивариуса** нужно последовательно выполнять 
действия из каждой секции. Действия такие:
* **Обработка списков архивариуса**. Списки из выбранного каталога сливаются в один файл. А списки должны 
быть такие: одно ключевое слово — один файл с названием, повторяющим ключевое слово.
* **Копирование файлов**. Файлы из слитых воедино списков **Архивариуса** копируются в выбранный каталог.
* **Создание отчета**. Рядом с  папкой со скопированными файлами появляется HTML-отчет, в котором в виде 
ссылок перечислены скопированные файлы. При нажатии на ссылку файл открывается тут же в браузере либо 
в связанной программе.

Все три секции программы независимы, пользоваться ими можно по отдельности. Особый интерес 
представляет копирование файлов. Здесь можно указать файл со списком абсолютных путей и они при 
некотором везении будут скопированы в выбранный каталог с **сохранением** структуры каталогов. 
Сохранение дерева каталогов я считаю важной особенностью, так как насмотрелся на плоские помойки из 
файлов, которые создают наши и (((наши))) криминалистические программы. 

Копирование файлов - само по себе хорошее дело, но **"Архивариус 3000"** ищет файлы, в том числе в 
архивах, и эти файлы нужно из архивов извлечь. Я слышал от некоторых экспертов, что они не 
достают файлы из архивов, а предоставляют архив целиком. С одной стороны, их можно понять, у них 
нет ПО, позволяющего автоматически распаковывать нужные файлы, а с другой стороны как-то не очень 
профессионально получается. Отдать следователю архив, в недрах которого скрывается заветный файл, 
означает: отдать ничто.

Так вот, **Архисрез** умеет доставать файлы из архивов. Для этого он использует архиватор 7zip. 
Если 7zip поддерживает данный тип файлов, значит распакует. Скорее всего. Потому что **Архивариус** умеет 
зализать во множество специфических контейнеров, таких как почтовые архивы и базы данных. И тут уж для 
распаковки придется использовать стороннее ПО. К счастью **Архисрез** ведет лог файлов, которые он не 
смог извлечь/скопировать.  
А еще файлы могут не копироваться из-за ошибок в самом **Архивариусе**. Перечислю ошибки, которые мне 
попадались:
- сломанные имена внутри архивов. Бывает, что **Архивариус** выдает вместо имен файлов краказябры. Это 
связано с тем, то внутри архива имена файлов записаны не той кодировкой, которую ожидает архиватор. 
Например, во вложенных архивах снаружи файлы описаны кодировкой «ANSI» а внутри «KOI-8».
- иногда **Архивариус** по непонятным причинам заменяет пробелы в путях на последовательность «%20». 
Соответственно, найти файл такой испорченный файл уже нельзя. Можно конечно принудительно заменять все 
символы «%20» на пробелы, но… Это сложный вопрос.
- порой **Архивариус** видит архивы там, где их нет. Часто это встречается в кэше браузеров, где лежат 
файлы без расширений. В качестве курьеза можно вспомнить документы Майкрософт Офис. Во времена массового 
перехода с «doc» на «docx» **Архивариус** распознавал их как файл «xml», упакованный в архив. По сути, 
конечно, так и есть, но эксперту от этого не легче.
