
на будущее:
 - у меня в агрегаторе просмотривается список файлов для обработки. Если файл валидный, он
   добавляется в список обработки. Если не валидный, то не добавляется. Но о том, что он не
   добавлен, ника не сообщается. Нужно это проверить.
 - запоминать последниие использовавшиеся файлы в инишнике
 - сделать кнопки "загрузить последние файлы"
 - внедрить модуль csv
 - в логи пишутся сведения о заархивированных файлах, это лишнее, надо будет убрать
 
29.09.2020
0.52
Редкая ошибка попалась - запароленный архив. Доя разархивирования запускается 7zip, он 
просит ввести пароль и на этом стопорится. Архисрез ждет заверщения 7z. Так что никаких 
ошибок не вылетает. ПРобовал читать вывод 7z пос трокам. но там разбтвка на строки 
происходит по возврату каретки. А пригоашение ввсети пароль каретку не переводит. Решил 
просто при разархивировании любого файла посылать энтер на вход 7z. не разбираясь, нужен 
ему пароль или нет. Так проще получается. Если требутеся пароль - просто вылетает ошибка 
разархивирования. Если не требуется - ввод энтера никакого влияния не оказывает.
Изменил форамат отчета о работе, теперь в первой позиции стоит год, а не день, из-за чего 
логи будут складываться в алфавитном порядке.

31.03.2020
0.51
Всплыла ошибка, когда в списках с избыточным количеством столбщов (вес, размер и т.д.) если
запись в последнем смтолбще нулевая, то считается, что в строке меньше столбщов, чем в
заголовке и возникает ошибка обращения по индексу. Проблема оказадась в том что rstrip()
без аргкмента удалял не только возврат каретки на конце, но и таб, служащий разжелителем
для столбцов.

10.03.2020
0.50
Грамотно сделал импорт модулей и вынес архиватор в отдельный каталог

01.11.2019
0.49
Небольшое исправление. Программа srez_zip_1.py запускается из внутреннего каталога по сравнению 
с архирезом. Из-за  этого ломается путь к архиватоту и на первом архиве программа крашится.
Добавил условная подстановка пути к архиватору в зависимости от того, что запущено srez_zip или 
архисрез.

28.10.2019
0.48
Для консольной версии скрипта srez_zip_1.py сделал, чтобы к файлам error.log и copy.log добавлялся 
посификс в ыиде обрабатываемого файла. Это делается в целях пакетной обработки множества файлов, 
чтобы для каждлго сохранялся свой отчет.

28.10.2019
0.47
Доработал файл srez_zip_1.py таким образом, чтобы его можно было запускать из командной строки 
отдельно, а не в составе архисреза. Основные цели, это:
1) использоватль для пакетной обработи - чтобы корировать сразу по скольким файл-спискам. Хотя, 
тут надо решить указание различных путей копирования, но это делается путями bat-скриптов. Или 
можно обертку на питоне всесто bat-скрипта сделать.
2) для копирования на обысках. На компьютерах, где не установлен питон. На флешку пожно записать 
портативную версию питона, но она не поддерживает графический интерфейс.

24.10.2019
0.46
Много раз модифицировал программу и ничего не записывал в ченджлог. Что я там делал  уже и не упомнишь, 
но изменения были довольно небольшими. Наконец собрался с силами изменить номер версии. Тут тоже 
изменение незначительное - это обработка файл-списков, у которых есть в имени файла запятая. Дело 
в том, что у меня ключевые фразы разделяются по запятым и внутри ключевых фраз не должно быть 
запятых, иначе при создании хтмл-отчета она побьется на n+1 кусков. В общем, в файле  agregator_01.py
добавил замену запятой на символ "\u0326" - немного похожий на запятую. В отчете archivarius_list.csv
эти символы заменяют запятые внутри ключевых фраз. Далее эти подмены переносятся в файл copy.log
А уже на основе него формируется отчет. На этот раз  в файле file_otchet_1.py запятые изменяются в 
обратную сторону и ключевые фразы в html-отчете имеют изначальный вид.
Я думал, что можно было бы модифицировать запятые только в файле copy.log, а в archivarius_list.csv
оставлять ключевые фразы без изменения. Но понял, что не могу этого сделать. Так как copy.log берет
имена ключевых фраз из archivarius_list.csv. Да и вообще говоря, тольшой нужды соблюдать запятые 
нет - неизменность ключевого слова нужна, чтобы по нему можно было что-нибудь найти. Но вот что, я 
не очень представляю.

16.05.2018
Лирическое отступление
Проблема в том, что в некоторых файлах встречаются такие странные сочетания символов 
как %20, он же символ пробела. Вот примерная строка:
Консум_Октябрь%202016((Autosaved-305523252657411930)).xlsb	I:\Users\СакураОрджоникидзе\AppData\Roaming\Microsoft\Excel\Консум_Октябрь%202016305497232303302301\
Что делает архивариус3000, когда встречает такие адреса? Он заменяет сочетание %20 
на пробел. Поэтому потом файл при копировании невозможно найти. Причем в моем 
случае такое же сочетание в пути не изменилось, а в имени файла было заменено на пробел.
Как с этим бороться не знаю. Если файл не находится, вместо каждого пробела 
подставлять %20 слишком расточительно. думаю, нужно просто помнить об этой проблеме.

13.09.2017
0.45
Добавил в программу функцию логирования. Так что в нескольких методах идут отчеты 
о работе. О копировании в основном. В дальнейшем логирование до ума надо довести.

Заметил, что файлы, которые копируются на основе списка путей, созданого в тотал 
коммандере, копируются не совсем корректно. А именно, файлы, содержащиеся в 
архивах не копируются совсем. Это связано с тем, что архивы в этих логах 
обозначаются не пайпами, как в архивариусе, а бэкслешами. А обработка бэкслэшей 
у меня в программе не предусмотрена. Поэтому поступил просто: 1) устанавливаю, 
что файл находится в архиве; 2) перед распаковкой бэкслэш мнеяю на пайп. Пока 
работает.

06.09.2017
0.44
Исправлен алгоритм формирования заголовка для создания  общего файл-списка из 
нескольких. До этого, если названия колонок отличались от стандартного 
"файл"-"папка"-"дата", то названия клолнок могли не совпалать с реальным 
содержимым колонки. Например, в колонке "дата" мог отображаться размер 
файлов.
Алгоритм заменен со случайного формирования номеров колонок на тот, где 
заголовки колонок идут по алфавиту (за исключением  первых "файл"-"папка").

29.06.2016
Увеличил оконо отображения информации с 9 до  14 строк, высота приложения в 
800 пикселей при этом не превышена.
Установил ограничения на минимальный и максимальный размеры окна.

24.03.2016
0.43
Дописал файл srez_zip_1.py - модуль копирования. А именно ту часть, которая
отвечает за распаковку из архивов. раньше файл считался распакованным
только кгода архиватор выдавал сообщение "Everything is Ok". Но дело в ом,
что архивы могут быть поврежденными, но при этом файлы из них будут
распаковываться нормально. Но архиватор будет выдавать ошибку. На этот
случай я усилил проверку. Во первых проверяется наличие распакованного
файла, а дальше вычисляется его контрольная сумма и сравнивается с той, что 
находится внутри архива.

20.01.2015
Слегка упростил создание html-отчета. Теперь  напротив ключевых слов нулевой 
длины не появляется количество файлов (левое окно; выглядео странно) Теперь 
нужно сделать, чтобы файлы с нулевой длиной сключевого слова просто не 
создавались.
--
Нужно подчистить файл srez_zip_1.py. Там какой-то отладочный вывод в консоль 
остался.
--
Хотел уменьшить число файлов в html-отчете, путем объединения заголовка и тела в 
правой части, но с использованием frame это невозможно, каждый фрейм ссылается 
на свой файл.

28.11.2014 
0.41
Добавлена нечувствительность к регистру заголовка файла архивариуса.
Исправлена ошибка, когда при обработке файлов с абсолютными путями для файлов из 
корневого каталога в пути присутстворвал двойной слэш. 
При этом обработка файлов с абсолютными путями не совсем доделана. Если в адресах 
встретятся бэкслэши или пайпы, они корректно не обработаются. Но вероятность 
встретить такие файлы довольно мала: пайпы ставит архивариус для файлов внутри 
архивов, а бэкслэши - тотал для архивов.

Ошибка:
Изменения, внесенные в версиях 0.39 и 0.40 столкнулись между собой: если 
коприровать файлы с абсолютными путями, то будут появлябться html- отчеты с 
невидимыми ключевыми словами (та как в оригинале ключевые слова отсутствуют, то 
в отчете они будут, но нулевой длины. Вот только теперь справа от слова нулевой 
длины указывается количество файлов с этим словом. То есть какя-то непонятная 
цифра сама по себе). Впрочем, баг не критический, ни на что не влияет, но вид 
портит. 

ОШИБКА: при использоании опции "полный путь" у файлов в корневом каталоге 
появляются два слэша. Необходимо добавить возможность копировать архивы целиком.

15.10.2014
0.40
В html-отчете появилась информация о количестве файлов с каждым ключевым словом.
А так же появилась нумерация самих файлов. реализовано это довольно коряво 
(избыточно) нужно причесывать.


13.05.2014
0.39
Теперь копировать можно простые списки файлов, без заголовков "Полный путь" и т.д.
Так же можно копировать первичные списки архивариуса (не объедененные), у которых 
отсутствует поле "ключевые слова". При этом HTML-отчет создается корректно. Хотя с 
ним ситуация довольно курьезная. Так как формат файла copy.log остается неизменным, 
в него продолжают писаться ключевые слова нулевой длины. Соответственно, в 
HTML-отчете в списке присутствует ключевое слово нулевой длины, но его нельзя 
открыть. Видимой остается только ссылка "Все файлы".

19.12.2013
0.38
Избавился от класса Disp в файле archisrez_v038.py, определив его графическую часть 
в классе Display_Gui. А так как он кроме графических функций в себе не содержит, то 
выполняет тупо функцию пустой обертки. Осталос реализовать нормальную функцию 
прогресс бара.

19.12.2013
0.37
немного переписал класс Report(). При отделении графического интерфейса от высших 
классах отпала необходимость в части переменных, так как они дублируются с 
переменными, привязанными к строковым формам. В данной версии были удалены переменные
self.otchet и self.copylog

18.12.2013
0.36
исправил ошибку, коприрвания (когда второй этап работы программы запускается сразу 
без первого). дело оказалось в рассинхорнизованности переменной класса SREZ 
и строковых переменных. Убрал переменную класса, теперь местоположение фала со 
списком файлов берется прямо из строки.
*********************
основная ошибка версии 0.35 - то что нельзя провести второй этап копирования без 
первого. Возникает онибка именно этот баг надо исправить в версии 0.36
*********************
0.3x - отсоединение графического интерфейса от основного кода

0.30 - немного отделил графический интерфейс от основного кода. Выделил низкоуровнеый 
графический класс Enbutt (строка + кнопка) в отдельный файл. Он унифицированно 
используется в интерфейсе.

0.29 - добавлено распознавание столбцов на этапе объединения различных файлов 
архивариуса. Распознает файлы с лбюым количеством столбцов в любом порядке, 
главное, чтобы был путь - абсолютный, либо двумя столбцами: имя "файла + путь.
Кроме того, в файле отчета внутри каталогов файлы отстртированы по алфавиту.

0.28 - добавлена замена пустых имен файлов на "text.txt" и восстановление сломанных 
документов xlsx в секции объединения списков архивариуса

0.27 - добавлено распознавание столбцов по заголовку в секции копирования файлов





На будущее. Существует такая проблема, когда копируешь файлы, и создаешь новый каталог, 
иногда возникают исключения из-за того, что доступ к каталогу уже занят и он не может 
создать начальный путь для копирования. Эту ситуацию нужно корректон отображать на дисплее 
и по возможности выходить из нее. (Ошибка возникает при удалении дерева каталогов, 
в котором уже находится другое приложение).
'''
'''
Класс Argegat использует переменную mother.output_directory для указания папки с файлами 
которые нужно обработать. Больше эта переменная нигде не используется, хоть и доступна 
другим классам через класс-родитель Application(). Класс Srez в той же ситуации использует 
переменную self.arch_list, отрезая от нее путь и отправляя в srez_zip.py
'''
'''
Не работает ввод непостредственно в строках ввода. 
В будущем, если в строку ввода вносятся изменения, то данные в других строках должны 
меняться синхронно. (каталог в Срез - Отчет).
'''
'''
Нужно сделать, чтобы формат входных файлов отслеживался на всех трех этапах работы
программы. Чтобы он не брал по умолчанию первый столбец - имя файла, второй - путь и тд.
Нужно читать заголовки и по ним формировать записи. И выдавать сообщения об ошибках.
'''
'''
При длительном копировании файлов интерфейс программы замирает, нужно его 
периодически обновлять
'''
'''
Неоходимо сделать защиту от неверной кодировки файла соссписком копируемых файлов
'''
'''
Для исправленных docx нужно узнавать дату изменения, а то сейчас там выводится 
1980 год 
'''
